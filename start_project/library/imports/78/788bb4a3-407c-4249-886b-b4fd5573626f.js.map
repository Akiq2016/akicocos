{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Game.js"],"names":["GLOBAL","require","cc","Class","extends","Component","properties","maxStarDuration","minStarDuration","starPrefab","default","type","Prefab","ground","Node","player","startBtn","scoreLabel","Label","scoreAudio","AudioClip","onLoad","groundY","y","height","enabled","update","dt","isValid","star","gameOver","timer","onEnable","starDuration","score","generateStar","getComponent","instantiate","node","addChild","setPosition","getStarPosition","game","getStarDuration","Math","random","randY","jumpHeight","randX","width","v2","gainScore","str","string","slice","indexOf","audioEngine","play","startGame","destroy","lastScore","director","loadScene"],"mappings":";;;;;;AAAA,IAAMA,SAASC,QAAQ,QAAR,CAAf;;AAEAC,GAAGC,KAAH,CAAS;AACPC,WAASF,GAAGG,SADL;;AAGPC,cAAY;AACVC,qBAAiB,CADP;AAEVC,qBAAiB,CAFP;AAGVC,gBAAY;AACVC,eAAS,IADC;AAEVC,YAAMT,GAAGU;AAFC,KAHF;AAOVC,YAAQ;AACNH,eAAS,IADH;AAENC,YAAMT,GAAGY;AAFH,KAPE;AAWVC,YAAQ;AACNL,eAAS,IADH;AAENC,YAAMT,GAAGY;AAFH,KAXE;AAeVE,cAAU;AACRN,eAAS,IADD;AAERC,YAAMT,GAAGY;AAFD,KAfA;AAmBVG,gBAAY;AACVP,eAAS,IADC;AAEVC,YAAMT,GAAGgB;AAFC,KAnBF;AAuBVC,gBAAY;AACVT,eAAS,IADC;AAEVC,YAAMT,GAAGkB;AAFC;AAvBF,GAHL;;AAgCPC,QAhCO,oBAgCG;AACR;AACA;AACA,SAAKC,OAAL,GAAe,KAAKT,MAAL,CAAYU,CAAZ,GAAgB,KAAKV,MAAL,CAAYW,MAAZ,GAAqB,CAApD;;AAEA;AACA,SAAKC,OAAL,GAAe,KAAf;AACD,GAvCM;AAyCPC,QAzCO,kBAyCCC,EAzCD,EAyCK;AACV,QAAI,CAACzB,GAAG0B,OAAH,CAAW,KAAKC,IAAhB,CAAL,EAA4B;AAC1B,WAAKC,QAAL;AACD,KAFD,MAEO;AACL,WAAKC,KAAL,IAAcJ,EAAd;AACD;AACF,GA/CM;AAiDPK,UAjDO,sBAiDK;AACV,SAAKD,KAAL,GAAa,CAAb;AACA,SAAKE,YAAL,GAAoB,CAApB;AACA,SAAKC,KAAL,GAAa,CAAb;AACA,SAAKC,YAAL;;AAEA;AACA,SAAKpB,MAAL,CAAYqB,YAAZ,CAAyB,QAAzB,EAAmCX,OAAnC,GAA6C,IAA7C;AACD,GAzDM;;;AA2DPU,gBAAc,wBAAW;AACvB;AACA,SAAKN,IAAL,GAAY3B,GAAGmC,WAAH,CAAe,KAAK5B,UAApB,CAAZ;AACA,SAAK6B,IAAL,CAAUC,QAAV,CAAmB,KAAKV,IAAxB;AACA,SAAKA,IAAL,CAAUW,WAAV,CAAsB,KAAKC,eAAL,EAAtB;AACA,SAAKZ,IAAL,CAAUO,YAAV,CAAuB,MAAvB,EAA+BM,IAA/B,GAAsC,IAAtC;;AAEA,SAAKT,YAAL,GAAoB,KAAKU,eAAL,EAApB;AACA,SAAKZ,KAAL,GAAa,CAAb;AACD,GApEM;;AAsEPY,mBAAiB,2BAAY;AAC3B,WAAO,KAAKnC,eAAL,GAAuBoC,KAAKC,MAAL,MAAiB,KAAKtC,eAAL,GAAuB,KAAKC,eAA7C,CAA9B;AACD,GAxEM;;AA0EPiC,mBAAiB,2BAAY;AAC3B,QAAIK,QAAQ,KAAKxB,OAAL,GAAesB,KAAKC,MAAL,KAAgB,KAAK9B,MAAL,CAAYqB,YAAZ,CAAyB,QAAzB,EAAmCW,UAA9E;AACA,QAAIC,QAAQ,CAACJ,KAAKC,MAAL,KAAgB,GAAjB,IAAwB,CAAxB,IAA6B,KAAKP,IAAL,CAAUW,KAAV,GAAkB,CAA/C,CAAZ;;AAEA,WAAO/C,GAAGgD,EAAH,CAAMF,KAAN,EAAaF,KAAb,CAAP;AACD,GA/EM;;AAiFPK,aAAW,qBAAY;AACrB,QAAIC,MAAM,KAAKnC,UAAL,CAAgBoC,MAA1B;AACA,SAAKnB,KAAL,IAAc,CAAd;AACA,SAAKjB,UAAL,CAAgBoC,MAAhB,GAAyBD,IAAIE,KAAJ,CAAU,CAAV,EAAaF,IAAIG,OAAJ,CAAY,GAAZ,IAAmB,CAAhC,IAAqC,KAAKrB,KAAnE;AACAhC,OAAGsD,WAAH,CAAeC,IAAf,CAAoB,KAAKtC,UAAzB,EAAqC,KAArC;AACD,GAtFM;;AAwFPuC,aAAW,qBAAY;AACrB,SAAKjC,OAAL,GAAe,IAAf;AACA,SAAKT,QAAL,CAAc2C,OAAd;AACD,GA3FM;;AA6FP7B,YAAU,oBAAY;AACpB,SAAKL,OAAL,GAAe,KAAf;AACAzB,WAAO4D,SAAP,GAAmB,KAAK1B,KAAxB;AACAhC,OAAG2D,QAAH,CAAYC,SAAZ,CAAsB,UAAtB;AACD;AAjGM,CAAT","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const GLOBAL = require('global')\r\n\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    maxStarDuration: 0,\r\n    minStarDuration: 0,\r\n    starPrefab: {\r\n      default: null,\r\n      type: cc.Prefab\r\n    },\r\n    ground: {\r\n      default: null,\r\n      type: cc.Node\r\n    },\r\n    player: {\r\n      default: null,\r\n      type: cc.Node\r\n    },\r\n    startBtn: {\r\n      default: null,\r\n      type: cc.Node\r\n    },\r\n    scoreLabel: {\r\n      default: null,\r\n      type: cc.Label\r\n    },\r\n    scoreAudio: {\r\n      default: null,\r\n      type: cc.AudioClip\r\n    }\r\n  },\r\n\r\n  onLoad () {\r\n    // Get the y-axis coordinate of the ground plane\r\n    // (that base on the anchor is still on the center position as default)\r\n    this.groundY = this.ground.y + this.ground.height / 2;\r\n\r\n    // init game status\r\n    this.enabled = false\r\n  },\r\n\r\n  update (dt) {\r\n    if (!cc.isValid(this.star)) {\r\n      this.gameOver();\r\n    } else {\r\n      this.timer += dt;\r\n    }\r\n  },\r\n\r\n  onEnable () {\r\n    this.timer = 0;\r\n    this.starDuration = 0;\r\n    this.score = 0;\r\n    this.generateStar();\r\n\r\n    // player\r\n    this.player.getComponent('Player').enabled = true\r\n  },\r\n\r\n  generateStar: function() {\r\n    // instantiate new nodes from Prefab\r\n    this.star = cc.instantiate(this.starPrefab);\r\n    this.node.addChild(this.star);\r\n    this.star.setPosition(this.getStarPosition());\r\n    this.star.getComponent('Star').game = this;\r\n\r\n    this.starDuration = this.getStarDuration()\r\n    this.timer = 0;\r\n  },\r\n\r\n  getStarDuration: function () {\r\n    return this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);\r\n  },\r\n\r\n  getStarPosition: function () {\r\n    var randY = this.groundY + Math.random() * this.player.getComponent('Player').jumpHeight;\r\n    var randX = (Math.random() - 0.5) * 2 * (this.node.width / 2);\r\n\r\n    return cc.v2(randX, randY);\r\n  },\r\n\r\n  gainScore: function () {\r\n    let str = this.scoreLabel.string\r\n    this.score += 1;\r\n    this.scoreLabel.string = str.slice(0, str.indexOf(':') + 2) + this.score;\r\n    cc.audioEngine.play(this.scoreAudio, false);\r\n  },\r\n\r\n  startGame: function () {\r\n    this.enabled = true;\r\n    this.startBtn.destroy();\r\n  },\r\n\r\n  gameOver: function () {\r\n    this.enabled = false;\r\n    GLOBAL.lastScore = this.score;\r\n    cc.director.loadScene('gameover');\r\n  },\r\n});\r\n"]}